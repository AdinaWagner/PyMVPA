# vim ft=yaml
# travis-ci.org definition for PyMVPA build (based on nipype configuration
# which in turn was based on nipy)
#
# We pretend to be erlang because we need can't use the python support in
# travis-ci; it uses virtualenvs, they do not have numpy, scipy, matplotlib,
# and it is impractical to build them
language: erlang
env:
 global:
    - PY=python PYSUF=''
    # - PYTHON=python3 PYSUF=3 : python3-numpy not currently available
 matrix:
    - PYTHON=$PY
    - PYTHON="$PY -O"
    - PYTHONPATH=mvpa/tests/badexternals
    - MVPA_DEBUG=ENFORCE_CA_ENABLED MVPA_DEBUG_METRICS=all
before_install:
    - sudo apt-get update -qq
    - sudo apt-get install lsb-release
    - source /etc/lsb-release
    - echo ${DISTRIB_CODENAME}
    - wget -O- http://neuro.debian.net/lists/${DISTRIB_CODENAME}.us-nh.full | sudo tee /etc/apt/sources.list.d/neurodebian.sources.list
    - sudo apt-key adv --recv-keys --keyserver pgp.mit.edu 2649A5A9
    - sudo apt-get update -qq
    - sudo apt-cache policy           # What is actually available?
    # - sudo apt-get install $PYTHON-dev
    - sudo apt-get install swig
    - sudo apt-get install $PY-numpy
    - sudo apt-get install $PY-scipy $PY-matplotlib
    - sudo apt-get install $PY-nose
    - travis_retry sudo apt-get install shogun-python-modular
    - travis_retry sudo apt-get install $PY-mdp $PY-psutil liblapack-dev
    - travis_retry sudo apt-get install $PY-nibabel $PY-nifti
install:
    - make
script:
    # Run only nonlabile tests but via coverage for the last entry in the matrix
    - make unittest-nonlabile
